extends ../layout

block content
  .pb-2.mt-2.mb-4.border-bottom
    h2
      i.fas.fa-robot.iconpadding
      | Retrieval-Augmented Generation (RAG) Demo

  .btn-group.d-flex(role='group')
    a.btn.btn-primary.w-100(href='https://huggingface.co/docs/api-inference/index', target='_blank')
      i.fas.fa-brain.fa-sm.iconpadding
      | Hugging Face Inference API
    a.btn.btn-primary.w-100(href='https://www.mongodb.com/docs/atlas/atlas-vector-search/', target='_blank')
      i.fas.fa-database.fa-sm.iconpadding
      | MongoDB Vector Search
    a.btn.btn-primary.w-100(href='https://js.langchain.com/docs/modules/indexes/vector_stores/integrations/mongodb_atlas', target='_blank')
      i.fas.fa-link.fa-sm.iconpadding
      | LangChain.js MongoDB

  .pb-2.mt-2.mb-4.border-bottom
    h2
      i.fas.fa-robot.fa-sm
      | Retrieval-Augmented Generation (RAG) Demo

  .row
    .col-md-6
      .card
        .card-body
          h3 Ingested Files
          if ingestedFiles && ingestedFiles.length > 0
            table.table
              thead
                tr
                  th File Name
              tbody
                each file in ingestedFiles
                  tr
                    td= file
          else
            p.text-muted No files ingested yet.

          form(action='/api/rag/ingest', method='POST')
            input(type='hidden', name='_csrf', value=_csrf)
            button.btn.btn-primary(type='submit')
              i.fas.fa-sync.fa-sm
              |
              | Update Data

    .col-md-6
      .card
        .card-body
          h3 Ask a Question
          form(action='/api/rag/ask', method='POST')
            input(type='hidden', name='_csrf', value=_csrf)
            .form-group
              label(for='question') Your Question:
              textarea#question.form-control(name='question', rows='3', maxlength=maxInputLength, required)= question
            button.btn.btn-primary.mt-3(type='submit')
              i.fas.fa-paper-plane.fa-sm
              |
              | Ask

  if ragResponse || llmResponse
    .row.mt-4
      if ragResponse
        .col-md-6
          .card
            .card-body
              h3
                i.fas.fa-database.fa-sm
                |
                | RAG Response
              .response-box
                pre.text-wrap= ragResponse
      if llmResponse
        .col-md-6
          .card
            .card-body
              h3
                i.fas.fa-brain.fa-sm
                |
                | LLM Response
              .response-box
                pre.text-wrap= llmResponse
  style.
    .response-box {
      background-color: #f8f9fa;
      padding: 15px;
      border-radius: 5px;
      margin-top: 10px;
    }
    pre.text-wrap {
      white-space: pre-wrap;
      word-wrap: break-word;
    }
