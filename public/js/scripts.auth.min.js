var Buddies=Backbone.Model.extend({urlRoot:"/api/v1/buddies",url:function(){return this.urlRoot}}),FindBuddies=Backbone.Model.extend({urlRoot:"/api/v1/buddies/find",url:function(){return this.urlRoot}}),AllBuddiesController=function(){var e=new Buddies;e.fetch().done(function(t){ReactDOM.render(React.createElement(AuthBuddies,{buddies:e.toJSON().buddies}),document.getElementById(window.APP.mounts.buddiesMount))})},FindBuddiesController=function(){ReactDOM.render(React.createElement(FindBuddiesR,null),document.getElementById(window.APP.mounts.buddiesMount))},InviteController=function(){ReactDOM.render(React.createElement(InviteBuddiesR,null),document.getElementById(window.APP.mounts.buddiesMount))},AuthNav=React.createClass({updateController:function(e){window.location.hash=e},render:function(){return React.createElement("div",null,React.createElement("button",{onClick:this.updateController.bind(this,"buddies")},"All"),React.createElement("button",{onClick:this.updateController.bind(this,"invite")},"Invite"),React.createElement("button",{onClick:this.updateController.bind(this,"find")},"Find"))}}),AuthBuddies=React.createClass({getInitialState:function(){return{buddies:this.props.buddies,buddiesPresent:this.props.buddies.length>0,inviteTemplate:"undefined"!=typeof this.props.requestType&&"find"===this.props.requestType}},componentDidMount:function(){var e=this;events.subscribe("findBuddies/result",function(t){e.setState({buddies:t.buddies,buddiesPresent:t.buddies.length>0,inviteTemplate:"find"===t.requestType})})},handleBuddiesChange:function(){return{buddies:this.props.buddies}},render:function(){var e=this;return React.createElement("div",{className:"buddies-main"},this.state.buddiesPresent?this.state.buddies.map(function(t,n){return React.createElement("div",{className:"BuddiesWrapper"},e.state.inviteTemplate?React.createElement(BuddyInvite,{key:n,buddy:t}):React.createElement(BuddyRow,{key:n,buddy:t}))}):React.createElement("div",{className:"no-buddies"}))}}),FindBuddiesR=React.createClass({getInitialState:function(){return{buddies:{}}},findBuddies:function(){var e=this;$.get("/api/v1/buddies/find/"+this.state.buddyDetail,function(t){e.setState({buddies:t.buddies}),events.publish("findBuddies/result",{buddies:e.state.buddies,requestType:"find"})})},handleTextChange:function(e){this.setState({buddyDetail:e.target.value})},render:function(){var e=this;return React.createElement("section",null,React.createElement("input",{type:"text",placeholder:"Type here",onChange:this.handleTextChange}),React.createElement("button",{onClick:this.findBuddies.bind(this)},"Find"),React.createElement(AuthBuddies,{buddies:e.state.buddies}))}}),BuddyRow=React.createClass({render:function(){return React.createElement("section",{className:"buddy"},this.props.buddy.email," | ",this.props.buddy.status," ",React.createElement(InviteBuddyMicro,{buddy:this.props.buddy}))}}),BuddyInvite=React.createClass({render:function(){return React.createElement("section",{className:"buddy"},this.props.buddy.email," ",React.createElement(InviteBuddyMicro,{buddy:this.props.buddy,msg:"Connect"}))}}),InviteBuddiesR=React.createClass({getInitialState:function(){return{buddyDetail:""}},handleTextChange:function(e){this.setState({buddyDetail:e.target.value})},sendInvite:function(){var e=this;$.ajax({url:"/api/v1/buddies/invite",data:{buddyEmail:e.state.buddyDetail}}).done(function(e){events.publish("admin/alert",{className:"text-success",msg:JSON.stringify(e)})}).fail(function(e){events.publish("admin/alert",{className:"text-danger",msg:JSON.stringify(e)})})},render:function(){return React.createElement("inviteForm",null,React.createElement("input",{type:"text",placeholder:"Email address",onChange:this.handleTextChange}),React.createElement("button",{onClick:this.sendInvite.bind(this)},"Send invite"))}}),InviteBuddyMicro=React.createClass({getInitialState:function(){return{msg:"undefined"==typeof this.props.msg?"Send Request":this.props.msg}},handleInvite:function(){"use strict";var e=this.props.buddy;$.get("/api/v1/invite/"+e._id,function(e){}).done(function(e){}).success(function(e){events.publish("admin/alert",{className:"text-success",msg:"Buddy request was sent"})}).fail(function(e){events.publish("admin/alert",{className:"text-danger",msg:"There was a problem sending request. Please try again."})})},render:function(){return React.createElement("button",{onClick:this.handleInvite.bind(this)},this.state.msg)}}),MessageMicro=React.createClass({getInitialState:function(){return{msg:"",messagePresent:!1,defaultClass:"text-danger",className:"text-danger"}},clearMessage:function(){var e=this;setTimeout(function(){e.setState({msg:"",messagePresent:!1,className:e.state.defaultClass})},1e4)},componentDidMount:function(){var e=this;events.subscribe("admin/alert",function(t){console.log(t.className),e.setState({msg:t.msg,messagePresent:!0,className:"undefined"!=typeof t.className?t.className:e.state.defaultClass}),e.clearMessage()})},render:function(){return React.createElement("messageWrapper",null,this.state.messagePresent?React.createElement("message",{className:this.state.className},this.state.msg):React.createElement("message",null))}}),AppRouter=Backbone.Router.extend({routes:{invite:"invite",find:"find","*actions":"defaultRoute"}}),app_router=new AppRouter;app_router.on("route:find",function(e){FindBuddiesController()}),app_router.on("route:invite",function(e){console.log("INVITE!!!!"),InviteController()}),app_router.on("route:defaultRoute",function(e){AllBuddiesController()}),Backbone.history.start(),ReactDOM.render(React.createElement(AuthNav,null),document.getElementById(window.APP.mounts.adminMount)),ReactDOM.render(React.createElement(MessageMicro),document.getElementById("auth-message"));